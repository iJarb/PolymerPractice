<link rel="import" href="../bower_components/polymer/polymer-element.html"/>
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/vaadin-text-field/vaadin-text-field.html">

<dom-module id="my-profile-register">
    <template>
    <style>
        paper-button {
            font-family: 'Roboto', 'Noto', sans-serif;
            font-weight: normal;
            font-size: 14px;
            -webkit-font-smoothing: antialiased;
        }
        paper-button.indigo {
            background-color: var(--paper-indigo-500);
            color: white;
            --paper-button-raised-keyboard-focus: {
                background-color: var(--paper-pink-a200) !important;
                color: white !important;
            };
        }

        form {
            margin: 20px 0;
        }
        .form-item {
            margin-bottom: 15px;
        }
    </style>

    <iron-form id="registerForm">
        <form method="post" action="/register">
            <div class="form-item">
                <vaadin-text-field label="User Name" minlength="4" maxlength="8" required pattern="^\w+$" value="TanBui" name="username"></vaadin-text-field>
                <br/><span>* from 4 to 8 characters without spaces</span>
            </div>
            <div class="form-item">
                <vaadin-text-field label="Email" required value="tan@vaadin.com" name="email"></vaadin-text-field>
                <br/><span>required</span>
            </div>
            <div class="form-item">
                <vaadin-text-field label="Age" pattern="\d\d\d*" required value="35" name="age"></vaadin-text-field>
                <br/><span>* 2 digits age</span>
            </div>
            <div class="form-item">
                <vaadin-text-field label="Password" required pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}" type="password" value="p@Ass123" name="password"></vaadin-text-field>
                <br/><span>* 6 characters min including uppercase and number</span>
            </div>
        </form>
        <div style="text-align: center;">
            <paper-button raised class="indigo" id="btnSubmit">Register</paper-button>
            <paper-button>Back</paper-button>
        </div>
    </iron-form>
    <div id="demoOutput"></div>
    </template>
    <script>
        class MyProfileRegister extends Polymer.Element {
            static get properties() { return {
                visible: {
                    type: Boolean,
                    value: false
                }
            }}

            static get is() {
                return 'my-profile-register';   // must be same as dom-module id
            }

            static get observers() { return [
                '_registerChanged(visible)'
            ]}

            ready() {
                super.ready();
                this.$.btnSubmit.addEventListener('click', e => {this._submit(e)});
                this.$.registerForm.addEventListener('iron-form-presubmit', e => {this._preProcessSubmit(e)});
                this.$.registerForm.addEventListener('iron-form-submit', e => {this._processSubmit(e)});
            }

            _submit(e) {
                if (!this.$.registerForm.validate()) {
                    window.alert('Please fill all required fields with valid values');
                } else {
                    this.$.registerForm.submit();
                }
            }
            _processSubmit(e) {
                this.$.demoOutput.innerHTML = JSON.stringify(event.detail);
            }
            _preProcessSubmit(e) {
                console.log(event.detail);
            }

            _registerChanged(visible) {
                if (!visible) {
                    return;
                }
                this.dispatchEvent(new CustomEvent('change-page', {
                    bubbles: true, composed: true, detail: { title: 'Register' }}));
            }
        }

        customElements.define(MyProfileRegister.is, MyProfileRegister);
    </script>
</dom-module>
